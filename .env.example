# =============================================================================
# ENVIRONMENT CONFIGURATION - COPY TO .env AND FILL IN VALUES
# =============================================================================
# SECURITY: Never commit .env files with real credentials!
# All secrets below must be generated fresh for each environment.

# =============================================================================
# DATABASE
# =============================================================================
# PostgreSQL password - generate a strong password
POSTGRES_PASSWORD=

# Full database connection URL (update password and host as needed)
DATABASE_URL=postgresql://licence:YOUR_PASSWORD_HERE@localhost:5432/licence

# Redis URL for caching and background tasks
REDIS_URL=redis://localhost:6379

# =============================================================================
# SECURITY - REQUIRED
# =============================================================================
# Generate encryption key (32 bytes, base64 encoded):
#   python -c "import secrets; print(secrets.token_urlsafe(32))"
ENCRYPTION_KEY=

# Legacy encryption keys for key rotation (comma-separated, oldest to newest)
# When rotating keys: move current ENCRYPTION_KEY to this list, generate new ENCRYPTION_KEY
# Example: ENCRYPTION_KEY_LEGACY=old_key_1,old_key_2
# ENCRYPTION_KEY_LEGACY=

# Generate JWT secret (minimum 32 characters):
#   python -c "import secrets; print(secrets.token_urlsafe(32))"
JWT_SECRET=

# JWT token expiration (hours) - short-lived for security
JWT_EXPIRATION_HOURS=1

# JWT token claims for validation
JWT_ISSUER=licence-api
JWT_AUDIENCE=licence-app

# Refresh token validity (days)
REFRESH_TOKEN_DAYS=30

# =============================================================================
# PASSWORD POLICY
# =============================================================================
PASSWORD_MIN_LENGTH=12
PASSWORD_HISTORY_COUNT=5
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=30


# =============================================================================
# FRONTEND API
# =============================================================================
NEXT_PUBLIC_API_URL=http://localhost:8000

# =============================================================================
# OPTIONAL SETTINGS
# =============================================================================
# Restrict login to specific email domain (e.g., yourcompany.com)
# ALLOWED_EMAIL_DOMAIN=

# CORS origins (comma-separated for multiple)
# CORS_ORIGINS=http://localhost:3000

# Environment: development, staging, production
ENVIRONMENT=development

# Debug mode (enables API docs, verbose logging)
DEBUG=false

# =============================================================================
# CORS SETTINGS
# =============================================================================
# Allowed origins for CORS (comma-separated for multiple)
CORS_ORIGINS=http://localhost:3000

# =============================================================================
# RATE LIMITING & PROXY
# =============================================================================
# Trusted proxy IP addresses/ranges for X-Forwarded-For header (comma-separated)
# Only these IPs are trusted to set forwarded headers
# Examples: 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 127.0.0.1
# TRUSTED_PROXIES=10.0.0.0/8,172.16.0.0/12

# Rate limits (requests per minute)
RATE_LIMIT_DEFAULT=100
RATE_LIMIT_AUTH_LOGIN=5
RATE_LIMIT_AUTH_REFRESH=10
RATE_LIMIT_AUTH_PASSWORD_CHANGE=3
RATE_LIMIT_AUTH_LOGOUT=10
RATE_LIMIT_ADMIN_USER_CREATE=10
RATE_LIMIT_ADMIN_ROLE_MODIFY=20
RATE_LIMIT_PROVIDER_TEST=10
RATE_LIMIT_SENSITIVE=5

# =============================================================================
# CACHE SETTINGS (TTL in seconds)
# =============================================================================
CACHE_TTL_DASHBOARD=300
CACHE_TTL_DEPARTMENTS=3600
CACHE_TTL_PROVIDERS=300
CACHE_TTL_PROVIDER_STATS=300
CACHE_TTL_LICENSE_STATS=300
CACHE_TTL_PAYMENT_METHODS=1800
CACHE_TTL_SETTINGS=3600

# =============================================================================
# AUDIT SETTINGS
# =============================================================================
# Number of days to retain audit logs
AUDIT_RETENTION_DAYS=365

# =============================================================================
# SESSION COOKIES
# =============================================================================
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=lax
